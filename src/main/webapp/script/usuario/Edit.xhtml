<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">

    <ui:composition template="/script/template_inbox_bootstrap_config.xhtml">
        <ui:define name="title">
            <p:outputLabel value="#{bundle.EditUsuarioTitle}"/>
        </ui:define>
        <ui:define name="menutitle">
            <p:outputLabel value="Editar Usuario"/>
        </ui:define>

        <ui:define name="help">
            <h:outputLabel escape="false" value="#{bundle.ayudaUsuarios}"/>
        </ui:define>
        <ui:define name="content_header">
            <script>
                var init = [];
                init.push(function () {
                    $('body').addClass('mmc');
                });
            </script>

            <!-- page-header -->
            <div class="page-header">
                <div class="row">
                    <div class="col-sm-6 col-xs-12">
                        <h1><i class="fa fa-user page-header-icon"></i>&nbsp;&nbsp;Editar Usuario</h1>
                        <p:commandLink title="Help" onclick="PF('helpDialog').show()" styleClass="text-info" >
                            <i class="fa fa-info-circle"/>
                        </p:commandLink> 
                    </div>

                </div>
            </div><!-- / .page-header --> 
        </ui:define>

        <ui:define name="body">

            <h:form>

                <p:fieldset legend="Identificacion del usuario">
                    <div class="row">
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                <label style="font-weight: bold;" for="idUsuario" class="control-label">#{bundle.EditUsuarioLabel_idUsuario}</label>
                                <h:inputText id="idUsuario" disabled="true" styleClass="form-control" 
                                             value="#{usuarioController.selected.idUsuario}" title="#{bundle.EditUsuarioTitle_idUsuario}"
                                             required="true" requiredMessage="#{bundle.EditUsuarioRequiredMessage_idUsuario}"
                                             />
                            </div>
                            <div class="form-group">
                                <label style="font-weight: bold;" for="Pass" class="control-label">Contraseña</label>
                                <h:inputSecret id="Pass" styleClass="form-control" 
                                               value="#{usuarioController.selected.pass}" title="Contraseña"
                                               required="false"
                                               >
                                </h:inputSecret>
                                <p:watermark for="Pass" value="(sin cambios)"/>
                            </div>
                            <div class="form-group">
                                <label style="font-weight: bold;" for="activo" class="control-label">#{bundle.EditUsuarioLabel_activo}</label>
                                <h:selectOneMenu styleClass="form-control" id="idCanalSalida" style="width: 300px;"
                                                 value="#{usuarioController.selected.activo}">
                                    <f:selectItem itemLabel="Si" itemValue="true"/>
                                    <f:selectItem itemLabel="No" itemValue="false"/>
                                </h:selectOneMenu>
                                <h:message for="idCanalSalida" errorClass="text-danger"/>
                            </div>
                        </div>
                    </div>
                </p:fieldset>
                <br/>
                <p:fieldset legend="Datos Personales">

                    <div class="row">
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                <label style="font-weight: bold;" for="rut" class="control-label">Rut:</label>
                                <h:inputText id="rut" styleClass="form-control" 
                                             value="#{usuarioController.selected.rut}" title="Rut del usuario">
                                    <p:ajax event="blur" listener="#{usuarioController.formateaRut}" update="rut, :mainform:messages"/>
                                </h:inputText>
                            </div>
                            <div class="form-group">
                                <label style="font-weight: bold;" for="nombres" class="control-label">#{bundle.EditUsuarioLabel_nombres}</label>
                                <h:inputText id="nombres" styleClass="form-control" 
                                             value="#{usuarioController.selected.nombres}" title="#{bundle.EditUsuarioTitle_nombres}"
                                             />
                            </div>
                            <div class="form-group">
                                <label style="font-weight: bold;" for="apellidos" class="control-label">#{bundle.EditUsuarioLabel_apellidos}</label>
                                <h:inputText id="apellidos" styleClass="form-control" 
                                             value="#{usuarioController.selected.apellidos}" title="#{bundle.EditUsuarioTitle_apellidos}"
                                             />
                            </div>
                            <div class="form-group">
                                <label style="font-weight: bold;" for="email" class="control-label">#{bundle.EditUsuarioLabel_email}</label>
                                <h:inputText id="email" styleClass="form-control" 
                                             value="#{usuarioController.selected.email}" title="#{bundle.EditUsuarioTitle_email}"
                                             />
                            </div>
                            <div class="form-group">
                                <label style="font-weight: bold;" for="telFijo" class="control-label">#{bundle.EditUsuarioLabel_telFijo}</label>
                                <h:inputText id="telFijo" styleClass="form-control" 
                                             value="#{usuarioController.selected.telFijo}" title="#{bundle.EditUsuarioTitle_telFijo}"
                                             />
                            </div>
                            <div class="form-group">
                                <label style="font-weight: bold;" for="telMovil" class="control-label">#{bundle.EditUsuarioLabel_telMovil}</label>
                                <h:inputText id="telMovil" styleClass="form-control" 
                                             value="#{usuarioController.selected.telMovil}" title="#{bundle.EditUsuarioTitle_telMovil}"
                                             />
                            </div>
                        </div>
                    </div>


                </p:fieldset>
                <br/>

                <p:fieldset legend="Datos de Organizacion">
                    <div class="row">
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                <label style="font-weight: bold;" for="supervisor" class="control-label">#{bundle.EditUsuarioLabel_supervisor}</label>
                                <h:selectOneMenu styleClass="form-control" id="supervisor" style="width: 300px;"
                                                 value="#{usuarioController.selected.supervisor}">
                                    <f:selectItems value="#{usuarioController.itemsAvailableSelectOneNoSystem}"/>
                                </h:selectOneMenu>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;" for="pojoPickList" class="control-label">&iquest;Asignar Grupos al Usuario?</label>
                                <p:pickList id="pojoPickList"  value="#{usuarioController.gruposDualListModel}" var="g" effect="slide" 
                                            itemValue="#{g}" itemLabel="#{g.nombre}" converter="GrupoConverter"
                                            showSourceControls="true" showTargetControls="true"  
                                            showSourceFilter="true" showTargetFilter="true" filterMatchMode="contains"> 

                                    <f:facet name="sourceCaption">Grupos</f:facet> 
                                    <f:facet name="targetCaption">Seleccionados</f:facet> 
                                    <p:column> 
                                        #{g.nombre} 
                                    </p:column> 

                                </p:pickList>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;" for="rolList" class="control-label">Roles:</label>
                                <p:selectManyCheckbox id="rolList" converter="RolConverter" value="#{usuarioController.selected.rolList}" layout="pageDirection">
                                    <f:selectItems  value="#{rolController.itemsAvailableSelectMany}" itemLabel="nombre" itemValue="idRol"/>
                                </p:selectManyCheckbox>
                            </div>

                        </div>
                    </div>

                </p:fieldset>
                <br/>

                <p:toolbar>  
                    <p:toolbarGroup align="left">   
                        <p:commandLink styleClass="btn btn-default btn-flat fa fa-reply" action="#{usuarioController.goBack()}" value="&nbsp;&nbsp;#{bundle.goBack}" 
                                       immediate="true" ajax="false"/>
                        <p:separator/> 
                        <p:commandLink styleClass="btn btn-primary btn-flat fa fa-eye" ajax="false" action="View" value="&nbsp;#{bundle.EditUsuarioViewLink}" 
                                       immediate="true"/>
                    </p:toolbarGroup>

                    <p:toolbarGroup align="right">   
                        <p:separator/> 
                        <p:commandLink styleClass="btn btn-primary btn-flat fa fa-save" ajax="false" action="#{usuarioController.update}" value="&nbsp;#{bundle.EditUsuarioSaveLink}"
                                       rendered="#{filtroAcceso.verificarAccesoAFuncionEditarAjustes()}"/>
                    </p:toolbarGroup>
                </p:toolbar>


            </h:form>
        </ui:define>
    </ui:composition>

</html>
