<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions"
      xmlns:go="http://java.sun.com/jsf/composite/go">


    <ui:composition template="/script/template_inbox_bootstrap_config.xhtml">
        <ui:define name="title">
            <h:outputText value="Global Settings"/>
        </ui:define>

        <ui:define name="westHeader">
            <h:outputText value="..." style="font-weight: bold"></h:outputText>
        </ui:define>

         <ui:define name="help">
            <h:outputText value="Global Settings"/>
        </ui:define>
        
        <ui:define name="head">
            <style type="text/css">

            </style>
        </ui:define>

        <ui:define name="content_header">
            <script>
                var init = [];
                init.push(function () {
                    $('body').addClass('mmc');
                });
            </script>

            <!-- page-header -->
            <div class="page-header">
                <div class="row">
                    <div class="col-sm-6 col-xs-12">
                        <h1><i class="fa fa-wrench page-header-icon"></i>&nbsp;&nbsp;Global Settings</h1>
                        <p:commandLink title="Help" onclick="PF('helpDialog').show()" styleClass="text-info" >
                            <i class="fa fa-info-circle"/>
                        </p:commandLink> 
                    </div>
                    <div class="col-sm-6 col-xs-12">
                        <h:form id="buttonsForm">

                            <div class="pull-right">

                                <div class="btn-group">
                                    <go:paginatorCounts controllerMBean="#{appSettingController}"/>
                                </div>

                                <go:paginatorBtnsBt controllerMBean="#{appSettingController}" update="@(form)"/>


                            </div>
                        </h:form>
                    </div>
                </div>
            </div><!-- / .page-header --> 
        </ui:define>
        <ui:define name="body">

            <go:vistasListBt id="vistasList" 
                             update="@(form)" 
                             controllerMBean="#{appSettingController}"
                             user="#{UserSessionBean.current}"/>
            <div class="panel search-panel">
                <h:form id="formfilter">
                    <go:filterView id="panelFilter0" titleIconClass="fa fa-filter page-header-icon"
                                   controllerMBean="#{appSettingController}" 
                                   vista="#{appSettingController.vista}"
                                   filterHelper="#{appSettingController.filterHelper}" 
                                   canChangeFilters="#{filtroAcceso.verificarAccesoAFiltrosIndex()}"
                                   update=":mainform:messages :form" vistaControllerBackOutcome="/script/appSetting/config"/>

                </h:form>
            </div>


            <h:form id="form" enctype="multipart/form-data">

                <div class="btn-toolbar pull-right">
                    <div class="btn-group">
                        <p:commandLink styleClass="btn btn-primary btn-flat" 
                                       action="#{appSettingController.submitForm}"  
                                       ajax="false"  >
                            <i class="fa fa-save"></i> #{bundle.Save}
                        </p:commandLink>  
                    </div> 
                </div>
                <div>
                    <p:dataTable value="#{appSettingController.items}" 
                                 var="data" styleClass="no-border paginated hide-column-names">

                        <p:column width="200">
                            <p:outputLabel value="#{data.label}" style="font-weight: bold;" styleClass="panel-padding"/>
                        </p:column>

                        <p:column>

                            <p:inputText id="txt" value="#{data.settingValue}" size="60" required="#{data.required}" 
                                         rendered="#{data.type eq 'input'}"/> 


                            <h:panelGrid columns="1" rendered="#{data.type eq 'inputhtml'}">

                                <p:inplace editor="true">
                                    <f:facet name="output">
                                        <h:outputText value="#{data.settingValue}" escape="false"/>
                                    </f:facet>
                                    <f:facet name="input">
                                        <pe:ckEditor id="settingValue" value="#{data.settingValue}" required="#{data.required}" width="560" height="210" language="es"
                                                     toolbar="#{applicationBean.ckEditorToolbar}"
                                                     customConfig="#{request.contextPath}/resources/js/ckeditor.js"/>
                                        <p:watermark for="settingValue" value="#{data.descripcion}"/>

                                    </f:facet>
                                </p:inplace>

                                <p:commandLink id="overlayBtn" value="Marcadores" />
                                <p:overlayPanel id="MarcadoresPanel" for="overlayBtn" hideEffect="fade" dynamic="true"> 
                                    <p:dataTable value="#{clippingController.availablePlaceHolders}" var="holder" 
                                                 emptyMessage="No hay placeholders disponibles.">
                                        <p:column headerText="Marcadores de posici칩n">
                                            <h:outputText value="\${#{holder}}"/>
                                        </p:column>
                                        <f:facet name="footer">
                                            <h:outputText value="Utilice marcadores de posici칩n para insertar informaci칩n (del caso) usada con frecuencia f치cilmente en el texto."/>
                                        </f:facet>
                                    </p:dataTable>
                                </p:overlayPanel>

                            </h:panelGrid>

                            <h:panelGrid columns="1" rendered="#{data.type eq 'inputtextarea'}">
                                <p:inplace editor="true" rendered="#{not empty data.settingValue}">
                                    <f:facet name="output">
                                        <h:outputText value="#{data.settingValue}" escape="false"/>
                                    </f:facet>
                                    <f:facet name="input">
                                        <p:inputTextarea  value="#{data.settingValue}" required="#{data.required}" />
                                    </f:facet>
                                </p:inplace>

                                <p:inputTextarea  value="#{data.settingValue}" required="#{data.required}" rendered="#{empty data.settingValue}"/>
                            </h:panelGrid>



                            <h:panelGrid columns="3"  rendered="#{data.type eq 'inputfile'}">

                                <h:panelGrid columns="2">
                                    <p:row>
                                        <p:graphicImage id="imageLogoPreview0" value="#{applicationBean.logo}" cache="false" width="200"/>

                                    </p:row>

                                    <p:row>
                                        <p:fileUpload id="logo" value="#{appSettingController.logoUploadFile}" uploadLabel="envia" 
                                                      mode="simple" update=":form"/>  

                                    </p:row>




                                </h:panelGrid>
                            </h:panelGrid>  

                            <p:selectOneButton value="#{data.settingValue}" required="#{data.required}"   rendered="#{data.type eq 'booleanchoice'}"
                                               style="vertical-align:middle;">
                                <f:selectItem itemLabel="Habilitado" itemValue="true"/>
                                <f:selectItem itemLabel="Desabilitado" itemValue="false"/>
                            </p:selectOneButton>

                            <br/>
                            <h:outputText value="#{data.descripcion}" style="color: #666666;line-height: 17px;margin: 5px 0 0;padding-bottom: 3px;"/>  

                            <br/>
                        </p:column>


                        <p:column>
                            <h:inputText value="#{data.grupo}"/>
                        </p:column>


                    </p:dataTable>
                </div>  
                <div class="btn-toolbar pull-right">
                    <div class="btn-group">
                        <p:commandLink styleClass="btn btn-primary btn-flat" 
                                       action="#{appSettingController.submitForm}"  
                                       ajax="false"  >
                            <i class="fa fa-save"></i> #{bundle.Save}
                        </p:commandLink>  
                    </div> 
                </div> 


                <div class="row text-center">
                    <go:paginatorCounts controllerMBean="#{appSettingController}"/>
                </div>


            </h:form>

            <p:panel>
                <p:outputLabel value="URL Para crear casos en su pagina web:" style="font-weight: bold;"/>
                <h:outputText id="clipboard_text" 
                              value="http://#{facesContext.externalContext.requestServerName}:#{facesContext.externalContext.requestServerPort}#{facesContext.externalContext.requestContextPath}/faces/public/newTicketEmbedded.xhtml?tenant=#{UserSessionBean.tenantId}"/>

                <button id="copy-button" aria-label="Copy the url" title="Copy the url"
                        class="js-zeroclipboard button-outline zeroclipboard-button" 
                        data-clipboard-target="clipboard_text" 
                        data-copied-hint="Copied!" type="button"><span class="fa fa-clipboard"></span></button>

            </p:panel>


            <br/>


        </ui:define>

        <ui:define name="dialogs">

        </ui:define>

        <ui:define name="scripts">
            <h:outputScript name="ZeroClipboard.min.js" library="js"/>

            <script type="text/javascript">
                ZeroClipboard.config({swfPath: "http://#{facesContext.externalContext.requestServerName}:#{facesContext.externalContext.requestServerPort}#{facesContext.externalContext.requestContextPath}/public/res/ZeroClipboard.swf"});

                var client = new ZeroClipboard(document.getElementById("copy-button"));

                client.on("ready", function (readyEvent) {
//                     alert( "ZeroClipboard SWF is ready!" );

                    client.on("aftercopy", function (event) {
                        // `this` === `client`
                        // `event.target` === the element that was clicked
//                        event.target.style.display = "none";
                        alert("Copied url to clipboard: " + event.data["text/plain"]);
                    });
                });
            </script>

        </ui:define>
    </ui:composition>

</html>
