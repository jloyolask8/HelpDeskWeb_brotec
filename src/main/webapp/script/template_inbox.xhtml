<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:pe="http://primefaces.org/ui/extensions">
    <f:view contentType="text/html" encoding="UTF-8">
        <h:head>
            <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
            <meta http-equiv="Pragma" content="no-cache" />
            <meta http-equiv="Expires" content="0" />
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
            <title><ui:insert name="title">#{applicationBean.helpdeskTitle}</ui:insert></title>           

            <h:outputStylesheet library="css" name="jsfcrud.css"/>
            <h:outputStylesheet library="awesome" name="css/font-awesome.css"/>

            <ui:insert name="head"></ui:insert>
            <style type="text/css">

                .ui-layout-north {
                    z-index:20 !important;
                    border: none !important;
                    overflow:visible !important;
                    border-width: 0px !important;
                    margin: 0px !important;
                    padding: 0px !important;
                }

                #j_idt13, #j_idt12, #j_idt11{
                    padding: 1px !important;
                    padding-top: 5px !important;
                    margin: 0px !important;
                }

                .ui-layout-north .ui-layout-unit-content {
                    overflow:visible !important;
                }

                .ui-layout-resizer-north {
                    visibility: hidden !important;
                }

                .ui-widget {
                    font-size: 12px !important;
                }

                .ui-layout-pane-west{
                    border: none !important;
                    padding-top: 0px !important;
                    padding-left: 1px !important;
                    margin-top: -5px !important;
                }

                .ui-layout-pane-center{
                    border: none !important;
                    padding-top: 0px !important;
                    padding-left: 1px !important;
                    margin-top: -5px !important;
                }

                .ui-layout-pane-right{
                    border: none !important;
                    padding-top: 0px !important;
                    padding-left: 1px !important;
                    margin-top: -5px !important;
                }

                .ui-toolbar-group-right{
                    margin-top: -4px;
                }
                .ui-toolbar-group-left{
                    margin-top: 3px;
                }

                .autocompleteTagsCreate .ui-autocomplete-multiple-container {
                    width: 600px;
                }

            </style>
            <script type="text/javascript">
                PrimeFaces.locales['es'] = {
                    closeText: 'Cerrar',
                    prevText: 'Anterior',
                    nextText: 'Siguiente',
                    monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
                    monthNamesShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
                    dayNames: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
                    dayNamesShort: ['Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab'],
                    dayNamesMin: ['D', 'L', 'M', 'X', 'J', 'V', 'S'],
                    weekHeader: 'Semana',
                    firstDay: 1,
                    isRTL: false,
                    showMonthAfterYear: false,
                    yearSuffix: '',
                    timeOnlyTitle: 'Sólo hora',
                    timeText: 'Tiempo',
                    hourText: 'Hora',
                    minuteText: 'Minuto',
                    secondText: 'Segundo',
                    currentText: 'Fecha actual',
                    ampm: false,
                    month: 'Mes',
                    week: 'Semana',
                    day: 'Día',
                    allDayText: 'Todo el día'
                };
            </script>

            <script type="text/javascript">
                function start() {
                    PF('statusDialog').show();
                }

                function stop() {
                    PF('statusDialog').hide();
                }
            </script>
            <h:outputScript name="jsf.js" library="javax.faces"/>

            <ui:insert name="scripts"></ui:insert>
        </h:head>

        <h:body id="mainbody">

            <pe:ajaxErrorHandler /> 


            <p:ajaxStatus style="display:block;">
                <f:facet name="default">
                    <h:outputText value="Por favor espere..." style="font-weight: bold;"/>
                </f:facet>               
            </p:ajaxStatus>


            <p:idleMonitor timeout="1200000">
                <p:ajax event="idle" listener="#{applicationBean.onIdle}" async="true" 
                        global="false" />
                <p:ajax event="active" listener="#{applicationBean.onActive}" update=":mainform:messages" />
            </p:idleMonitor>

            <h:form id="mainform" style="height: 100%">
                <p:growl id="messages" life="30000" autoUpdate="true"  globalOnly="true" widgetVar="messages"
                         showDetail="true">
                </p:growl>
            </h:form>

            <pe:layout id="fullPage" widgetVar="pagelayout" fullPage="true" stateCookie="true" >  
                <pe:layoutPane position="north" closable="false" resizable="false">  
                    <ui:insert name="header">

                        <h:form id="formTopMenu">

                            <p:menubar id="menubar" autoDisplay="false" >
                                <p:menuitem action="#{casoController.inbox}" 
                                            ajax="false" value="Inbox" icon="fa fa-inbox"></p:menuitem>
                                <p:submenu label="Casos" icon="fa fa-ticket">
                                    <p:menuitem value="Crear Nuevo Caso" action="#{casoController.prepareCreate}" ajax="false" icon="ui-icon ui-icon-plus"/>  
                                    <p:menuitem value="Crear Nuevo Caso Pre-Entrega" action="#{casoController.prepareCreateCasoPreentrega}" ajax="false" icon="paintbrushicon"
                                                rendered="#{filtroAcceso.verificarAccesoACrearCasoPreentrega()}"/>  
                                </p:submenu>

                                <p:menuitem value="Clientes" action="#{clienteController.prepareList}" ajax="false" icon="fa fa-group"/>
                                <p:menuitem value="#{applicationBean.productDescription}(s)" action="#{productoController.prepareList}"
                                            ajax="false" icon="fa fa-building-o"/>

                                <p:menuitem value="Agenda" action="#{globalScheduleController.prepareList}" ajax="false" icon="fa fa-calendar"/>

                                <p:submenu label="Supervision" icon="fa fa-eye" rendered="#{filtroAcceso.verificarAccesoAFuncionSupervision()}">
                                    <p:menuitem value="Alertas" action="#{auditLogController.alertList()}" ajax="false" icon="ui-icon ui-icon-alert"></p:menuitem>
                                    <p:menuitem value="Logs de Casos" ajax="false" action="#{auditLogController.prepareList}" icon="ui-icon ui-icon-info"></p:menuitem>
                                    <p:menuitem value="Reportes" ajax="false" action="/script/report_graphs/reports" icon="chartbaricon"></p:menuitem>
                                </p:submenu>

                                <p:submenu label="Ajustes" icon="fa fa-wrench" rendered="#{filtroAcceso.verificarAccesoAFuncionEditarAjustes()}">                                

                                    <p:menuitem value="Áreas" action="#{areaController.prepareList}" ajax="false" icon="fa fa-sitemap"/>
                                    <p:menuitem value="Canales" action="#{canalController.prepareList}" ajax="false" icon="fa fa-exchange"/>
                                    <p:separator/>
                                    <p:menuitem value="Roles de Usuario" action="#{rolController.prepareList}" ajax="false" icon="fa fa-key"/>
                                    <p:menuitem value="Usuarios/Agentes" action="#{usuarioController.prepareList}" ajax="false" icon="fa fa-user"/>
                                    <p:menuitem value="Grupos de Agentes" action="#{grupoController.prepareList}" ajax="false" icon="fa fa-users"/>
                                    <p:separator/>
                                    <p:menuitem ajax="false" action="#{vistaController.prepareList()}" value="Vistas" icon="fa fa-filter"
                                                disabled="#{not filtroAcceso.verificarAccesoAFuncionAdministrarVistas()}"/>
                                    <p:menuitem value="Categorías" action="#{categoriaController.prepareList}" ajax="false" icon="fa fa-folder"/>
                                    <p:menuitem value="Sub Estados de Casos" action="#{subEstadoCasoController.prepareList}" ajax="false" icon="fa fa-bookmark"/>
                                    <p:menuitem value="Tipos de Casos" action="#{tipoCasoController.prepareList}" ajax="false" icon="fa fa-exclamation"/>
                                    <p:separator/>
                                    <p:menuitem value="SLA y Prioridad de Casos" action="#{prioridadController.prepareList}" ajax="false" icon="fa fa-bell"/>
                                    <p:menuitem value="Reglas de Negocio" action="#{reglaTriggerController.prepareList()}" ajax="false" icon="fa fa-cogs"/>
                                    <p:separator/>
                                    <p:menuitem value="Items de pre-entrega" action="#{itemController.prepareList}" ajax="false" icon="fa fa-briefcase"
                                                rendered="#{filtroAcceso.verificarAccesoAFuncionAdministrarItemsPreentrega()}"/>
                                    <p:separator/>
                                    <p:menuitem value="Lista negra (Correos)" action="#{blackListController.prepareList}" ajax="false" icon="fa fa-ban"  />
                                    <p:menuitem value="Configuración" action="#{appSettingController.goToConfigPage}" ajax="false" icon="fa fa-wrench" />

                                </p:submenu>


                                <p:submenu label="Ajustes de Sistema" icon="ui-icon ui-icon-wrench" rendered="#{filtroAcceso.esUsuarioSistema()}">
                                    <p:menuitem value="Funciones del Sistema" action="#{funcionController.prepareList()}" ajax="false" icon="ui-icon-wrench" />
                                    <p:menuitem value="Estados de Casos" action="#{estadoCasoController.prepareList()}" ajax="false" icon="ui-icon-wrench" />
                                    <p:menuitem value="Jobs Agendados" action="/script/scheduler/jobs" ajax="false" icon="ui-icon-wrench" />
                                </p:submenu>    

                                <p:submenu label="Mi Cuenta" icon="fa fa-user">                                
                                    <p:menuitem value="Mis Datos" action="myAccount" ajax="false" icon="ui-icon ui-icon-person"></p:menuitem>
                                    <p:menuitem value="Respuestas Predefinidas" action="#{clippingController.prepareList()}" ajax="false" icon="ui-icon ui-icon-comment"></p:menuitem>
                                    <p:menuitem value="Cambiar Contraseña" onclick="panelChangePass.show()" icon="ui-icon ui-icon-key"></p:menuitem>
                                    <p:menuitem action="#{loginController.logout_action}" ajax="false" value="Cerrar Sesión" icon="ui-icon ui-icon-power"></p:menuitem>
                                </p:submenu>



                                <p:menuitem id="casosPendientes" value="#{casoController.casosPendientes}"
                                            disabled="#{casoController.casosPendientes eq 0}" ajax="false"
                                            action="#{casoController.filtraPorAlertaPendiente}" update="formfilter:filtros  formfilter:panelG1"
                                            icon="pendienteicon"/>
                                <p:menuitem id="casosPorVencer" value="#{casoController.casosPorVencer}"
                                            disabled="#{casoController.casosPorVencer eq 0}" ajax="false"
                                            action="#{casoController.filtraPorAlertaPorVencer}" update="formfilter:filtros  formfilter:panelG1"
                                            icon="porvencericon"/>
                                <p:menuitem id="casosVencidos" value="#{casoController.casosVencido}"
                                            disabled="#{casoController.casosVencido eq 0}" ajax="false"
                                            action="#{casoController.filtraPorAlertaVencido}" update="formfilter:filtros  formfilter:panelG1"
                                            icon="vencidoicon"/>
                                <p:menuitem id="casosActualizados" value="#{casoController.countCasosRevisarActualizacion}"
                                            disabled="#{casoController.countCasosRevisarActualizacion eq 0}" ajax="false"
                                            action="#{casoController.filtraRevisarActualizaciones}" update="formfilter:filtros  formfilter:panelG1"
                                            icon="actualizadoicon">
                                </p:menuitem>





                                <f:facet name="options">

                                    <h:panelGrid columns="3">
                                        <p:ajaxStatus style="margin-right:25px">
                                            <f:facet name="start">
                                                <p:graphicImage library="images" name="ajax-loader_red.gif" />
                                            </f:facet>
                                        </p:ajaxStatus>

                                        <p:inputText id="idCaso" value="#{casoController.idCaso}" title="#{bundle.EditCasoTitle_idCaso}"
                                                     placeholder="id caso" style="margin-right:10px" size="6"/>
                                        <p:commandButton ajax="false" action="#{casoController.prepareEditCaso}" icon="ui-icon ui-icon-search"/>
                                    </h:panelGrid>

                                </f:facet>

                            </p:menubar>

                            <p:tooltip for=":formTopMenu:casosActualizados" value="Casos con actualizaciones no revisadas" showEffect="fade" hideEffect="fade" />
                            <p:tooltip for=":formTopMenu:casosPendientes" value="Casos pendientes de resolver" showEffect="fade" hideEffect="fade" />
                            <p:tooltip for=":formTopMenu:casosPorVencer" value="Casos por vencer" showEffect="fade" hideEffect="fade" />
                            <p:tooltip for=":formTopMenu:casosVencidos" value="Casos vencidos" showEffect="fade" hideEffect="fade" />
                        </h:form>









                    </ui:insert>  
                </pe:layoutPane>  

                <pe:layoutPane position="west" size="280" resizable="true" >               

                    <ui:insert name="west"/>               

                </pe:layoutPane> 

                <pe:layoutPane position="center">  



                    <ui:insert name="body"></ui:insert>
                </pe:layoutPane> 






            </pe:layout>  


            <p:dialog modal="true" widgetVar="statusDialog" header="Espere..." appendTo="@(body)" dynamic="false"
                      transient="true" draggable="false" closable="false" resizable="false">  
                <p:graphicImage library="images" name="ajaxloadingbar.gif" />
            </p:dialog>





            <p:dialog id="panelChangePassId" appendTo="@(body)" closeOnEscape="true" widgetVar="panelChangePass" header="Cambiar Contraseña" modal="true">
                <h:form id="changePassForm">
                    <p:messages id="messages" showDetail="false" autoUpdate="true"/>  
                    <h:panelGrid columns="2" id="matchGrid">                     
                        <p:outputLabel for="pwd" value="Contraseña Actual: " style="font-weight: bold;"/>  
                        <p:password id="pwd" value="#{loginController.passwordCurrent}" label="Contraseña Actual" required="true" />  

                        <p:outputLabel for="pwd1" value="Nueva Contraseña: " style="font-weight: bold;"/>  
                        <p:password id="pwd1" value="#{loginController.passwordNew1}" match="pwd2" label="Nueva Contraseña" required="true" feedback="true" 
                                    promptLabel="Favor ingrese contraseña" weakLabel="Débil"  
                                    goodLabel="Buena" strongLabel="Fuerte" />  

                        <p:outputLabel for="pwd2" value="Repita Nueva Contraseña: " style="font-weight: bold;"/>  
                        <p:password id="pwd2" value="#{loginController.passwordNew2}" label="Repita Nueva Contraseña" required="true" feedback="true"   
                                    promptLabel="Favor repita contraseña" weakLabel="Débil"  
                                    goodLabel="Buena" strongLabel="Fuerte"/>  
                    </h:panelGrid> 
                    <br/>
                    <p:separator/>
                    <p:commandButton id="saveButton" update=":changePassForm" value="Cambiar" action="#{loginController.changePass()}"/>  


                </h:form>
            </p:dialog>


            <ui:insert name="dialogs"/>


        </h:body>
    </f:view>
</html>


